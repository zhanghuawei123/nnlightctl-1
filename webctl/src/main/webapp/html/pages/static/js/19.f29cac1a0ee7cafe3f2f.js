webpackJsonp([19],{K8Pg:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l("EMlb"),i={name:"OverView",data:function(){return{projectList:[],pageNumber:1,pageSize:10,multipleSelection:[],currentPage:1,newProject:{nnlightctlProjectCountryId:null,nnlightctlProjectProvinceId:null,nnlightctlProjectCityId:null,type:1,projectName:null,projectCode:null,mem:null,state:!0},addProjectrules:{nnlightctlProjectCountryId:[{required:!0,message:"选择不得为空",trigger:"blur"}],nnlightctlProjectProvinceId:[{required:!0,message:"选择不得为空",trigger:"blur"}],nnlightctlProjectCityId:[{required:!0,message:"选择不得为空",trigger:"blur"}],type:[{required:!0,message:"选择不得为空",trigger:"change"}],projectName:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],projectCode:[{required:!0,message:"填写内容不得为空",trigger:"blur"}]},dialogFormVisible:!1,dialogFormVisibleEdit:!1,countryList:[],provinceList:[],cityList:[],typeList:[{value:1,label:"道路照明系统"}],editIndex:0,allTotal:0,addNewObjShow:!1,dialogTitle:["国家","省份","城市"],dialogType:0,addObj:{name:null,code:null,mem:null,longitude:null,latitude:null,timeZone:null},addCityrules:{name:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],code:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],mem:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],longitude:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],latitude:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],timeZone:[{required:!0,message:"填写内容不得为空",trigger:"blur"}]}}},methods:{handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.pageSize=e,this.getListProject()},handleCurrentChange:function(e){this.pageNumber=e,this.getListProject()},getListProject:function(){var e=this,t=this;Object(o.l)(t.pageNumber,t.pageSize).then(function(l){t.projectList=l.data,t.projectList.length>0?e.allTotal=l.total:e.allTotal=0}).catch(function(e){console.log(e)})},editRow:function(e){var t=this;this.editIndex=e,Object(o.i)(this.projectList[e].codeNumber).then(function(e){t.newProject=e.data[0],console.log(e),1===t.newProject.state?t.newProject.state=!0:t.newProject.state=!1,t.dialogFormVisibleEdit=!0})},addProject:function(){this.dialogFormVisible=!0},deleteRow:function(e,t){var l=this,i=[];1===e?i.push(this.projectList[t].id):this.multipleSelection.length>0?this.multipleSelection.forEach(function(e){i.push(e.id)}):this.$message({message:"请勾选需要删除的数据",type:"warning"}),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.a)(i).then(function(e){l.$message({type:"success",message:"删除成功!"}),l.getListProject()}).catch(function(e){console.log(e)})}).catch(function(){l.$message({type:"info",message:"已取消删除"})})},goRules:function(e){var t=this;this.$refs[e].validate(function(e){e?t.onSubmit():console.log("error submit!!")})},onSubmit:function(){var e=this;this.newProject.state?this.newProject.state=1:this.newProject.state=0,Object(o.e)(this.newProject).then(function(t){e.$message({type:"success",message:"添加成功!"}),e.getListProject(),e.dialogFormVisible=!1,e.handleCloseDialog()}).catch(function(e){console.log(e)})},goEditRules:function(e){var t=this;this.$refs[e].validate(function(e){e?t.onEditSubmit():console.log("error submit!!")})},onEditSubmit:function(){var e=this;this.newProject.state?this.newProject.state=1:this.newProject.state=0,Object(o.n)(this.newProject).then(function(t){e.$message({type:"success",message:"修改成功!"}),e.getListProject(),e.dialogFormVisibleEdit=!1,e.handleCloseDialog1()}).catch(function(e){console.log(e)})},handleCloseDialog:function(e){this.newProject={countryName:"",provinceName:"",cityName:"",type:1,projectName:"",mem:"",state:1},this.$refs.projectForm.resetFields(),e()},handleCloseDialog1:function(e){this.newProject={countryName:"",provinceName:"",cityName:"",type:1,projectName:"",mem:"",state:1},this.$refs.editProjectForm.resetFields(),e()},getListCountry:function(){var e=this;Object(o.k)().then(function(t){e.countryList=t.data}).catch(function(e){console.log(e)})},getListProvince:function(){var e=this;Object(o.m)().then(function(t){e.provinceList=t.data}).catch(function(e){console.log(e)})},getListCity:function(){var e=this;Object(o.j)().then(function(t){e.cityList=t.data}).catch(function(e){console.log(e)})},addNewObj:function(e){this.dialogType=e,this.addNewObjShow=!0},goCityRules:function(e){var t=this;this.$refs[e].validate(function(e){e?t.onSubmitCity():console.log("error submit!!")})},onSubmitCity:function(){var e=this,t={};0===this.dialogType?(t.countryName=this.addObj.name,t.codeNumber=this.addObj.code,t.mem=this.addObj.mem,Object(o.c)(t).then(function(t){e.$message({type:"success",message:"添加成功"}),e.getListCountry(),e.addNewObjShow=!1,e.handleCloseAddCity()}).catch(function(e){console.log(e)})):1===this.dialogType?(t.provinceName=this.addObj.name,t.codeNumber=this.addObj.code,t.mem=this.addObj.mem,Object(o.d)(t).then(function(t){e.$message({type:"success",message:"添加成功"}),e.getListProvince(),e.addNewObjShow=!1,e.handleCloseAddCity()}).catch(function(e){console.log(e)})):2===this.dialogType&&(t.cityName=this.addObj.name,t.codeNumber=this.addObj.code,t.longitude=this.addObj.longitude,t.latitude=this.addObj.latitude,t.timeZone=this.addObj.timeZone,t.mem=this.addObj.mem,Object(o.b)(t).then(function(t){e.$message({type:"success",message:"添加成功"}),e.getListCity(),e.addNewObjShow=!1,e.handleCloseAddCity()}).catch(function(e){console.log(e)}))},handleCloseAddCity:function(e){this.addObj={name:null,code:null,mem:null,longitude:null,latitude:null,timeZone:null},this.$refs.rulesform.resetFields(),e()}},created:function(){this.getListProject(),this.getListCountry(),this.getListProvince(),this.getListCity()},destroyed:function(){}},n={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"system-container"},[l("div",{staticClass:"system-top clearfix"},[l("div",{staticClass:"item-block f-l"},[l("span",{staticClass:"title"},[e._v("地点")]),l("el-input",{attrs:{placeholder:"请输入内容"}})],1),e._v(" "),l("div",{staticClass:"item-block f-l"},[l("span",{staticClass:"title"},[e._v("名称")]),l("el-input",{attrs:{placeholder:"请输入内容"}})],1),e._v(" "),l("div",{staticClass:"btn-block f-r"},[l("el-button",{attrs:{type:"primary"}},[e._v("查询")])],1)]),e._v(" "),l("div",{staticClass:"system-center"},[l("div",{staticClass:"operation-bar"},[l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addProject()}}},[e._v("增加")]),e._v(" "),l("el-button",{on:{click:function(t){e.deleteRow(2)}}},[e._v("删除")])],1),e._v(" "),l("div",{staticClass:"data-list"},[l("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.projectList,"tooltip-effect":"dark","header-row-class-name":"datalist-header"},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{fixed:"",type:"selection",width:"40"}}),e._v(" "),l("el-table-column",{attrs:{fixed:"",prop:"codeNumber",label:"编码",width:"180"}}),e._v(" "),l("el-table-column",{attrs:{prop:"projectName",label:"名称",width:"200"}}),e._v(" "),l("el-table-column",{attrs:{prop:"contryName",label:"国家",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{prop:"provinceName",label:"省份",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{prop:"cityName",label:"城市",width:"80"}}),e._v(" "),l("el-table-column",{attrs:{label:"类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?l("span",[e._v("\n              道路照明系统\n            ")]):e._e()]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"longitude",label:"经度",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"latitude",label:"纬度",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{prop:"mem",label:"备注",width:"200"}}),e._v(" "),l("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.state?l("span",[e._v("\n              已启用\n            ")]):l("span",[e._v("\n              未开启\n            ")])]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"lights",label:"灯具"}}),e._v(" "),l("el-table-column",{attrs:{prop:"eleboxs",label:"配电柜"}}),e._v(" "),l("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(l){l.preventDefault(),e.editRow(t.$index)}}},[e._v("\n              编辑\n            ")]),e._v(" "),l("el-button",{staticClass:"danger-text-btn",attrs:{type:"text",size:"small"},nativeOn:{click:function(l){l.preventDefault(),e.deleteRow(1,t.$index)}}},[e._v("\n              删除\n            ")])]}}])})],1)],1),e._v(" "),l("div",{staticClass:"pagelist-block"},[l("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.allTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),l("el-dialog",{attrs:{title:"新建项目",visible:e.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,center:"","before-close":e.handleCloseDialog},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-form",{ref:"projectForm",attrs:{model:e.newProject,rules:e.addProjectrules,"label-width":"50px"}},[l("el-form-item",{attrs:{label:"国家",required:"",prop:"nnlightctlProjectCountryId"}},[l("el-select",{staticClass:"width350",model:{value:e.newProject.nnlightctlProjectCountryId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectCountryId",t)},expression:"newProject.nnlightctlProjectCountryId"}},e._l(e.countryList,function(e,t){return l("el-option",{key:t,attrs:{label:e.countryName,value:e.id}})})),e._v(" "),l("span",{staticClass:"add-city-span",on:{click:function(t){e.addNewObj(0)}}},[l("i",{staticClass:"iconfont"},[e._v("")]),e._v("添加")])],1),e._v(" "),l("el-form-item",{attrs:{label:"省份",required:"",prop:"nnlightctlProjectProvinceId"}},[l("el-select",{staticClass:"width350",model:{value:e.newProject.nnlightctlProjectProvinceId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectProvinceId",t)},expression:"newProject.nnlightctlProjectProvinceId"}},e._l(e.provinceList,function(e,t){return l("el-option",{key:t,attrs:{label:e.provinceName,value:e.id}})})),e._v(" "),l("span",{staticClass:"add-city-span",on:{click:function(t){e.addNewObj(1)}}},[l("i",{staticClass:"iconfont"},[e._v("")]),e._v("添加")])],1),e._v(" "),l("el-form-item",{attrs:{label:"城市",required:"",prop:"nnlightctlProjectCityId"}},[l("el-select",{staticClass:"width350",model:{value:e.newProject.nnlightctlProjectCityId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectCityId",t)},expression:"newProject.nnlightctlProjectCityId"}},e._l(e.cityList,function(e,t){return l("el-option",{key:t,attrs:{label:e.cityName,value:e.id}})})),e._v(" "),l("span",{staticClass:"add-city-span",on:{click:function(t){e.addNewObj(2)}}},[l("i",{staticClass:"iconfont"},[e._v("")]),e._v("添加")])],1),e._v(" "),l("el-form-item",{attrs:{label:"类型",required:"",prop:"type"}},[l("el-select",{staticClass:"width350",model:{value:e.newProject.type,callback:function(t){e.$set(e.newProject,"type",t)},expression:"newProject.type"}},e._l(e.typeList,function(e,t){return l("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"编码",required:"",prop:"projectCode"}},[l("el-input",{staticClass:"width350",model:{value:e.newProject.projectCode,callback:function(t){e.$set(e.newProject,"projectCode",t)},expression:"newProject.projectCode"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"名称",required:"",prop:"projectName"}},[l("el-input",{staticClass:"width350",model:{value:e.newProject.projectName,callback:function(t){e.$set(e.newProject,"projectName",t)},expression:"newProject.projectName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.newProject.mem,callback:function(t){e.$set(e.newProject,"mem",t)},expression:"newProject.mem"}})],1),e._v(" "),l("el-form-item",[l("el-checkbox",{model:{value:e.newProject.state,callback:function(t){e.$set(e.newProject,"state",t)},expression:"newProject.state"}},[e._v("启用")])],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.goRules("projectForm")}}},[e._v("确 定")])],1),e._v(" "),l("el-dialog",{attrs:{title:"添加"+e.dialogTitle[e.dialogType],visible:e.addNewObjShow,"close-on-click-modal":!1,"close-on-press-escape":!1,center:"","append-to-body":"","before-close":e.handleCloseAddCity},on:{"update:visible":function(t){e.addNewObjShow=t}}},[l("el-form",{ref:"rulesform",attrs:{model:e.addObj,rules:e.addCityrules,"label-width":"50px"}},[l("el-form-item",{attrs:{label:e.dialogTitle[e.dialogType],prop:"name",required:""}},[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.addObj.name,callback:function(t){e.$set(e.addObj,"name",t)},expression:"addObj.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"编码",prop:"code",required:""}},[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.addObj.code,callback:function(t){e.$set(e.addObj,"code",t)},expression:"addObj.code"}})],1),e._v(" "),2==e.dialogType?l("div",[l("el-form-item",{attrs:{label:"经度",prop:"longitude",required:""}},[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.addObj.longitude,callback:function(t){e.$set(e.addObj,"longitude",t)},expression:"addObj.longitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"纬度",prop:"latitude",required:""}},[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.addObj.latitude,callback:function(t){e.$set(e.addObj,"latitude",t)},expression:"addObj.latitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"时区",prop:"timeZone",required:""}},[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.addObj.timeZone,callback:function(t){e.$set(e.addObj,"timeZone",t)},expression:"addObj.timeZone"}})],1)],1):e._e(),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.addObj.mem,callback:function(t){e.$set(e.addObj,"mem",t)},expression:"addObj.mem"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.addNewObjShow=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.goCityRules("rulesform")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"修改项目",visible:e.dialogFormVisibleEdit,"close-on-click-modal":!1,"close-on-press-escape":!1,center:"","before-close":e.handleCloseDialog1},on:{"update:visible":function(t){e.dialogFormVisibleEdit=t}}},[l("el-form",{ref:"editProjectForm",attrs:{model:e.newProject,rules:e.addProjectrules,"label-width":"50px"}},[l("el-form-item",{attrs:{label:"国家",required:""}},[l("el-select",{staticClass:"width350",attrs:{disabled:""},model:{value:e.newProject.nnlightctlProjectCountryId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectCountryId",t)},expression:"newProject.nnlightctlProjectCountryId"}},e._l(e.countryList,function(e,t){return l("el-option",{key:t,attrs:{label:e.countryName,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"省份",required:""}},[l("el-select",{staticClass:"width350",attrs:{disabled:""},model:{value:e.newProject.nnlightctlProjectProvinceId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectProvinceId",t)},expression:"newProject.nnlightctlProjectProvinceId"}},e._l(e.provinceList,function(e,t){return l("el-option",{key:t,attrs:{label:e.provinceName,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"城市",required:""}},[l("el-select",{staticClass:"width350",attrs:{disabled:""},model:{value:e.newProject.nnlightctlProjectCityId,callback:function(t){e.$set(e.newProject,"nnlightctlProjectCityId",t)},expression:"newProject.nnlightctlProjectCityId"}},e._l(e.cityList,function(e,t){return l("el-option",{key:t,attrs:{label:e.cityName,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:"类型",required:""}},[1==e.newProject.ctype?l("span",{staticClass:"text"},[e._v("道路照明系统")]):e._e()]),e._v(" "),l("el-form-item",{attrs:{label:"编码",required:"",prop:"codeNumber"}},[l("el-input",{staticClass:"width350",attrs:{disabled:""},model:{value:e.newProject.codeNumber,callback:function(t){e.$set(e.newProject,"codeNumber",t)},expression:"newProject.codeNumber"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"名称",required:"",prop:"projectName"}},[l("el-input",{staticClass:"width350",model:{value:e.newProject.projectName,callback:function(t){e.$set(e.newProject,"projectName",t)},expression:"newProject.projectName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"纬度"}},[l("el-input",{staticClass:"width350",model:{value:e.newProject.latitude,callback:function(t){e.$set(e.newProject,"latitude",t)},expression:"newProject.latitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"经度"}},[l("el-input",{staticClass:"width350",model:{value:e.newProject.longitude,callback:function(t){e.$set(e.newProject,"longitude",t)},expression:"newProject.longitude"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.newProject.mem,callback:function(t){e.$set(e.newProject,"mem",t)},expression:"newProject.mem"}})],1),e._v(" "),l("el-form-item",[l("el-checkbox",{model:{value:e.newProject.state,callback:function(t){e.$set(e.newProject,"state",t)},expression:"newProject.state"}},[e._v("启用")])],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisibleEdit=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){e.goEditRules("editProjectForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var a=l("VU/8")(i,n,!1,function(e){l("ZnUu"),l("hlA5")},"data-v-406f60d5",null);t.default=a.exports},ZnUu:function(e,t){},hlA5:function(e,t){}});
//# sourceMappingURL=19.f29cac1a0ee7cafe3f2f.js.map