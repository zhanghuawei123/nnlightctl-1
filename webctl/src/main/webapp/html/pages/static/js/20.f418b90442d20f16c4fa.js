webpackJsonp([20],{"0pIk":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("YGWM"),l=(n("9GaH"),{name:"organization",data:function(){return{addTypeText:["添加","修改"],addType:0,pageNumber:1,pageSize:10,multipleSelection:[],currentPage:1,allTotal:null,newObject:{},addDialog:!1,listDepartment:[],listAllDepartment:[],listAllInstitution:[],addNewRules:{departmentName:[{required:!0,message:"填写内容不得为空",trigger:"blur"}],nnlightctlInstitutionIdBelong:[{required:!0,message:"填写内容不得为空",trigger:"change"}]}}},methods:{handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.pageNumber=e,this.getListDepartment()},handleSizeChange:function(e){this.pageSize=e,this.getListDepartment()},addNewObject:function(){this.addType=0,this.addDialog=!0},onSubmit:function(){this.addOrUpdateDepartment()},handleCloseDialog:function(e){this.newObject={},this.$refs.addNewForm.resetFields(),e()},addOrUpdateDepartment:function(){var e=this;"是"===this.newObject.departmentLevel?this.newObject.departmentLevel=0:this.newObject.departmentLevel=1,Object(a.a)(this.newObject).then(function(t){e.$message({type:"success",message:"修改成功!"}),e.getListDepartment(),e.addDialog=!1,e.newObject={},e.$refs.addNewForm.resetFields()}).catch(function(e){console.log(e)})},getListDepartment:function(){var e=this,t=this;Object(a.j)(t.pageNumber,t.pageSize).then(function(n){t.listDepartment=n.data,t.listDepartment.length>0?e.allTotal=n.total:e.allTotal=0}).catch(function(e){console.log(e)})},getAllListDepartment:function(){var e=this;Object(a.j)().then(function(t){e.listAllDepartment=t.data}).catch(function(e){console.log(e)})},getAllListInstitution:function(){var e=this;Object(a.k)().then(function(t){e.listAllInstitution=t.data}).catch(function(e){console.log(e)})},editRow:function(e){var t=this;this.addType=1;var n=this;Object(a.g)(this.listDepartment[e].id).then(function(e){0===e.data[0].departmentLevel?e.data[0].departmentLevel="是":e.data[0].departmentLevel="否",n.newObject=e.data[0],t.addDialog=!0}).catch(function(e){console.log(e)})},deleteRow:function(e,t){var n=this,l=[];if(1===e)l.push(this.listDepartment[t].id);else{if(!(this.multipleSelection.length>0))return this.$message({message:"请勾选需要删除的数据",type:"warning"}),!1;this.multipleSelection.forEach(function(e){l.push(e.id)})}this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.d)(l).then(function(e){n.$message({type:"success",message:"删除成功!"}),n.getListDepartment()}).catch(function(e){console.log(e)})}).catch(function(){n.$message({type:"info",message:"已取消删除"})})}},created:function(){this.getListDepartment(),this.getAllListDepartment(),this.getAllListInstitution()},destroyed:function(){}}),i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"system-container"},[n("div",{staticClass:"system-top clearfix"},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"}}),e._v(" "),n("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},slot:"append"})],1),e._v(" "),n("div",{staticClass:"system-center"},[n("div",{staticClass:"operation-bar"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addNewObject()}}},[e._v("增加")]),e._v(" "),n("el-button",{on:{click:function(t){e.deleteRow(2)}}},[e._v("删除")])],1),e._v(" "),n("div",{staticClass:"data-list"},[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.listDepartment,"tooltip-effect":"dark","header-row-class-name":"datalist-header"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{fixed:"",type:"selection",width:"40"}}),e._v(" "),n("el-table-column",{attrs:{prop:"departmentName",fixed:"left",label:"部门名称",width:"100"}}),e._v(" "),n("el-table-column",{attrs:{label:"最高级别部门",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.departmentLevel?n("span",[e._v("是")]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"创建时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("timeFormat")(t.row.gmtCreated))+"\n            ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"修改时间",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("timeFormat")(t.row.gmtUpdated))+"\n            ")]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"addr",label:"部门地址"}}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(n){n.preventDefault(),e.editRow(t.$index)}}},[e._v("\n                编辑\n              ")]),e._v(" "),n("el-button",{staticClass:"danger-text-btn",attrs:{type:"text",size:"small"},nativeOn:{click:function(n){n.preventDefault(),e.deleteRow(1,t.$index)}}},[e._v("\n                删除\n              ")])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"pagelist-block"},[n("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.allTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),n("el-dialog",{attrs:{title:e.addTypeText[e.addType]+"部门",visible:e.addDialog,"close-on-click-modal":!1,"close-on-press-escape":!1,center:"","before-close":e.handleCloseDialog},on:{"update:visible":function(t){e.addDialog=t}}},[n("el-form",{ref:"addNewForm",attrs:{"label-width":"120px",model:e.newObject,rules:e.addNewRules}},[n("el-form-item",{attrs:{label:"部门名称",prop:"departmentName",required:""}},[n("el-input",{model:{value:e.newObject.departmentName,callback:function(t){e.$set(e.newObject,"departmentName",t)},expression:"newObject.departmentName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"部门所属机构",required:"",prop:"nnlightctlInstitutionIdBelong"}},[n("el-select",{model:{value:e.newObject.nnlightctlInstitutionIdBelong,callback:function(t){e.$set(e.newObject,"nnlightctlInstitutionIdBelong",t)},expression:"newObject.nnlightctlInstitutionIdBelong"}},e._l(e.listAllInstitution,function(e,t){return n("el-option",{key:t,attrs:{label:e.institutionName,value:e.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"父部门",required:""}},[n("el-select",{model:{value:e.newObject.nnlightctlDepartmentIdParent,callback:function(t){e.$set(e.newObject,"nnlightctlDepartmentIdParent",t)},expression:"newObject.nnlightctlDepartmentIdParent"}},e._l(e.listAllDepartment,function(e,t){return n("el-option",{key:t,attrs:{label:e.departmentName,value:e.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"是否是最高级别",required:""}},[n("el-radio-group",{model:{value:e.newObject.departmentLevel,callback:function(t){e.$set(e.newObject,"departmentLevel",t)},expression:"newObject.departmentLevel"}},[n("el-radio",{attrs:{label:"是"}}),e._v(" "),n("el-radio",{attrs:{label:"否"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"部门地址"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.newObject.addr,callback:function(t){e.$set(e.newObject,"addr",t)},expression:"newObject.addr"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:e.newObject.mem,callback:function(t){e.$set(e.newObject,"mem",t)},expression:"newObject.mem"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=n("VU/8")(l,i,!1,function(e){n("NnPv"),n("VgGb")},"data-v-1d24b01c",null);t.default=s.exports},NnPv:function(e,t){},VgGb:function(e,t){}});
//# sourceMappingURL=20.f418b90442d20f16c4fa.js.map